# set命令的详细介绍

我们前面的课程介绍过set命令的一些简单用法，那么在今天的课程中将详细的向大家
讲解有关set命令的使用和它的一些重要参数作用。
set命令在批处理可以用来设置自定义变量,也可以用来修改变量的值.
非常有用,要学好批处理,必须会用set.

## 一、先回顾下前几课讲到set命令的使用

(1)例子：
@echo off
set var=新世纪网安
echo %var%
pause

在批处理中我们要引用这个变就把var变量名用两个%(百分号)扩起来,如%var%
这个例子中var这个变量我们已经定义好了并且给它赋了一个初值就是“新世纪网安”!
那么这也是它最简单的用法。这个应该很好理解把，我相信大家都明白了吧

(2)例子：
@echo off
set /p var=请给变量赋个值：
echo %var%
pause

前面也说过，就是能够让批处理程序和用户进行一个交互的操作，那么这个就是/p参数的
作用了。也很好理解吧

二、我们现在来学习下set /a这个参数的使用

首先说明下，这个/a参数主要是用来数学运算的。就好比是1+1=2，4-2=2，2*2=4，6/3=2
呵，很简单吧，先列下参数/a有那些运算符

()                  - 分组
! ~ -               - 一元运算符
* / %               - 算数运算符
+ -                 - 算数运算符
<< >>               - 逻辑移位
                    - 按位“与”
^                   - 按位“异”
|                   - 按位“或”
= *= /= %= += -=    - 赋值
&= ^= |= <<= >>=
,                   - 表达式分隔符

看几个例子就明白了：
set /a var=1+1
set /a var=4-2
set /a var=2*2
set /a var=6/3
set /a var=(1+1)+(1+1)
set /a a=1+1,b=1+2,c=1+3

好，在来看下在原变量上进行加减乘除的操作
set /a var+=1
这是一种简写方法，其原形就是
set /a var=%var%+1
那么加减乘除同样是如此，这个我就不介绍了。大家只要明白了使用一种
其他也就不用多说了。
还有一些“与”，“异”，“或”运算符，就和C语言中的一样，同样俩看几个例子

set /a var= 1 "|" 1
set /a var= 1 "^" 1
set /a var= 1 "&" 1
set /a var= 1 "+" 1
set /a var= 1 "%" 1
set /a var= 2 "<<" 2
set /a var= 4 ">>" 2
这些什么“异”，“或”运算符大家简单的了解一下

三、环境变量替换增强用法

(1)%PATH:str1=str2%
例子(1)：
@echo off
set var=www.510hack.com
echo 原样输出:“%var%”
set var=%var:1=2%
echo 修改后的:“%var%”
pause

例子(2)：
@echo off
set var=www.520hack.com
echo 原样输出:“%var%”
set var=%var:.=新世纪网安%
echo 修改后的:“%var%”
pause

这是一种替换变量值的用法，只要理解了它就明白了set var=%var:1=2%

(2)%PATH:~10,5%
例子：
@echo off
set var=www.520hack.com
set var=%var:~1,3%
echo %var%
pause

首先说明下，这是一种截取字符的用法。用上例中我们可以看出要截取的字符是从第一个
字符开始，然后截取它后面的三个字符。大家明白了吗？
好，再来看下下面的这几种用法
%PATH:~-10%
例子：
@echo off
set var=www.520hack.com
set var=%var:~-5%
echo %var%
pause

它就是截取变量var值的最后五位，看下结果就知道了。那么改成正数也是一样的
可以修改下

%PATH:~0,-2%
例子：
@echo off
set var=www.520hack.com
set var=%var:~0,-5%
echo %var%
pause

解释下这种截取的方法，它就是从0开始一直到最后的五个字符为之，不知道大家
有没有明白，当然大家可以随便修改自己要截取的字符
比如：

@echo off
set var=www.520hack.com
set var=%var:~3,-5%
echo %var%
pause

小结：今天给大家介绍了一些有关set命令比较重要的一些参数，大家不要以为这些参数
不重要，它在编写批处理程序中用法很灵活
所以希望大家能够好好的掌握，为后面的学习打下坚实的基础



　　set 　　　　设置环境变量 
［适用场合］　　设置声卡和路径等时用到 
［用　　法］　　set [环境变量]=[字符串] 　　 
　　　　　　　　这条命令常常用在autoexec.bat中 
［例　　子］　　C:\>set blaster=a220 i5 d1　　　　　设置声卡的参数 
　　　　　　　　C:\>set path=c:\dos　　　　　　　　　path c:\dos含义相同

显示、设置或删除变量。
    显示变量：set 或 set s 前者显示批处理当前已定义的所有变量及其值，
后者显示所有以s开头的变量及值。
    设置变量：set aa=abcd 此句命令便可向变量aa赋值abcd。
如果变量aa已被定义，
则aa的值被修改为abcd；若aa尚未定义，则此句命令即可定义新的变量aa，
同时为变量aa赋予初始值abcd。
    删除变量：set aa= 此句命令即可删除变量aa。若变量aa已被定义，
则删除变量aa；若aa尚未定义，则此句命令为实质意义。

    需要说明的是，批处理中的变量是不区分类型的，不需要像C语言中的变量
那样还要区分int、float、char等。比如执行set aa=345后，
变量aa的值既可以被视为数字345，也可以被视为字符串345。
    set命令具有扩展功能，如用作交互输入、字符串处理、数值计算等，属于高级命令范畴。



使用set /?查看SET的帮助我们发现SET除了我上面讲的
SET [variable=[string]]
SET /P variable=[promptString]
这两种语法外,还有如下几种语法:
SET /A expression
环境变量替换已如下增强:
%PATH:str1=str2%
%PATH:~10,5%
%PATH:~-10%
%PATH:~0,-2%

这机种语法有什么用处呢?现在我们来一个个讲解他们!

SET /A expression  
/A 命令行开关指定等号右边的字符串为被评估的数字表达式。该表达式
评估器很简单并以递减的优先权顺序支持下列操作:
    ()                  - 分组
    ! ~ -               - 一元运算符
    * / %               - 算数运算符
    + -                 - 算数运算符
    << >>               - 逻辑移位
    &                   - 按位“与”
    ^                   - 按位“异”
    |                   - 按位“或”
    = *= /= %= += -=    - 赋值
      &= ^= |= <<= >>=
    ,                   - 表达式分隔符


上面这些是系统帮助里的内容,看着是不是有点晕,没关系我来简单解释一下:
set的/A参数就是让SET可以支持数学符号进行加减等一些数学运算!

现在开始举例子介绍这些数学符号的用法:
看例子 这里的例子请直接在CMD下拷贝命令运行,不需要保存为BAT!
set /a var=1 + 1  
set /a 语法, var变量名 1 + 1 数学式子

拷贝运行后会直接显示一个2,或者运行完后我们输入echo %var%,也是二,这就是
一个简单的加法运算!

set /a var=2 - 1  结果是多少呢?如果你看不到结果就echo %var%.....
set /a var=2 * 2 乘法运算
set /a var=2 / 2 除法运算
set /a var=(1+1) + (1+1) 结果等于4 看得懂吧!
set /a a=1+1,b=2+1,c=3+1  运行后会显示一个4,但我们用
echo %a% %b% %c%后看结果,会发现其他数学运算也有效果!,这就是"斗"号的
作用!
有时候我们需要直接在原变量进行加减操作就可以用这种语法
set /a var+=1  这样的语法对应原始语法就是set /a var = %var% + 1
都是一样的结果,在原变量的值上在进行数学运算,不过这样写简单一点
在来一个:  
set /a var*=2 
其他都这么用,只要帮助里有这个语法!

另外还有一些用逻辑或取余操作符,这些符号,按照上面的使用方法会报错的

比如我们在CMD里输入set /a var=1 & 1 "与运算",他并不会显示为1,而是报错,
为什么?对于这样的"逻辑或取余操作符",我们需要把他们用双引号引起来,看例子    这个地方很容易被忽略掉！！！！！（2018）

set /a var= 1 "&" 1 这样结果就显示出来了,其他逻辑或取余操作符用法
set /a var= 1 "+" 1 异运算
set /a var= 1 "%" 1  取模运算

这些符号也可以用  &= ^= |= <<= >>= 这样的简单用法如
set /a var"+=" 1 等于set /a var = %var% + 1 注意引号

好符号说到这,现在说%PATH:str1=str2%
这个是替换变量值的内容,看例子
@echo off
set a= bbs.verybat.cn
echo 替换前的值: "%a%"
set var=%a: =%
echo 替换后的值: "%var%"
pause

对比一下,我们发现他把变量%a%的空格给替换掉了,从这个例子,我们就可以发现
%PATH:str1=str2%这个操作就是把变量%PATH%的里的str1全部用str2替换

比如我们把上面的例子改成这样
@echo off
set a=bbs.verybat.cn
echo 替换前的值: "%a%"
set var=%a:.=伤脑筋%
echo 替换后的值: "%var%"
pause

解释set var=%a:.=伤脑筋%
    set命令 var变量名 字a是要进行字符替换的变量的值,"."为要替换的值,
"伤脑筋"为替换后的值!
执行后就会把变量%a%里面的"."全部替换为"伤脑筋"
这就是set的替换字符的很好的功能!先讲到这

%PATH:~10,5%  这个什么意思,看例子:

@echo off
set a=bbs.verybat.cn
set var=%a:~1,2%
echo %var%
pause

执行后,我们会发现只显示了"bs"两个字母,我们的变量%a%的值不是为bbs.verybat.cn吗
怎么只显示了第2个字母和第3个字母"bs",分析一结果我们就可以很容易看出
%PATH:~10,5%就是显示变量PATH里指定几位的值!
分析set var=%a:~1,2%
  set命令 var变量值  a要进行字符操作的变量 "1"从变量"a"第几位开始显示 "2"显示几位
和起来就是把变量a的值从第一位开始,把后两位赋予给变量var     解释可以（2018）
就样因该明白了吧~

其他两种语法
%PATH:~-10%
%PATH:~0,-2%
他们也是显示指定变量指定几位的值得的意思

%PATH:~-10% 例子

@echo off
set a=bbs.verybat.cn
set var=%a:~-3%
echo %var%
pause
这个就是把变量a倒数3位的值给变量VAR

当然我们也可以改成这样
@echo off
set a=bbs.verybat.cn
set var=%a:~3%
echo %var%
pause

这个就是把变量a的从第3位开始后面全部的值给变量VAR

%PATH:~0,-2%  例子

@echo off
set a=bbs.verybat.cn
set var=%a:~0,-3%
echo %var%
pause
执行后,我们发现显示的是"bbs.verybat",少了".cn"
从结果分析,很容易分析出,这是把变量a的值从0位开始,
到倒数第三位之间的值全部赋予给var
如果改成这样

@echo off
set a=bbs.verybat.cn
set var=%a:~2,-3%
echo %var%
pause
那么他就是显示从第2位开始带倒数第三位字符的值,并赋予给变量var










